<!DOCTYPE html>
<html>
  <head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-44Y9CNCHR8"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-44Y9CNCHR8');
    </script>
    <meta content='actividad, adiciones, actividad reciente, adiciones recientes, modificaciones, cambios recientes, cambios' name='keywords'/>
    <meta content='Actividad en jucardus.com.' name='description'/>
    <meta content='Julio Cárdenas Pelizzari' name='author'/>
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.2.0/github-markdown-dark.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JUCARDUS.COM</title>
    <style>
      @media (max-width: 768px) {
        body {
          padding: 30px 4px 130px 4px !important;
          width: auto !important;
          overflow-x: hidden !important;
        }
        #contenido {
          max-width: 100% !important;
        }
        #estrella {
          padding: 25px 0px 30px 0px !important;
        }
        #tituloo {
          position: sticky !important;
          top: 17px !important;
          z-index: 1000 !important;
          margin-top: 17px !important;
          background-color: #145 !important;
          margin-bottom: 37px !important;
        }
      }
      a:link, a:visited {
        color: #cfd;
        text-decoration: none;
      }
      a:hover {
        color: Gold;
      }
      a:focus, a:active {
        color: Gold;
      }
      a.titulo:link, a.titulo:visited, a.titulo:hover, a.titulo:active {
        color: #034;
        font-size: 120%;
        font-weight: bold;
        text-decoration: none;
        }
      a.titulo:focus, a.titulo:hover {
        color: OrangeRed;
        text-decoration: none;
        }
      #barrita {
        background-color: #145;
        height: 17px;
        position: fixed;
        width: 100%;
        top: 0px;
      }
      #barrita {
        background-color: #145;
        height: 17px;
        position: fixed;
        width: 100%;
        top: 0px;
        z-index: 1000; /* Higher than titulo's 999 */
      }
      body {
        background-color: #145;
        color: #b7c6cc;
        color: #d3dce0;
        font-family: 'Ubuntu';
        font-size: 100%;
        letter-spacing: 1.1px;
        padding: 80px 21% 190px 20%;
      }
      #contenido {
        text-align: center;
      }
      #estrella {
        color: Ivory;
        font-size: 130%;
        font-weight: bold;
        opacity: 0.8;
        padding: 20px 0px 30px 0px;
        text-align: center;
        display: none!important;
      }
      img {
        width: 100px;
      }
      #markdown-content {
        font-size: 93%;
        margin-top: 50px!important;
        text-align: left!important;
      }
      .markdown-heading {
        margin-bottom: 26px;
      }
      #prrfs {
        background-color: #145;
        border-radius: 10px;
          -webkit-transition: .5s all;
          -webkit-transition-delay: .5s;
          -moz-transition: .5s all;
          -moz-transition-delay: .5s;
          -ms-transition: .5s all;
          -ms-transition-delay: .5s;
          -o-transition: .5s all;
          -o-transition-delay: .5s;
          transition: .3s all;
          transition-delay: 0.1s;
        margin-bottom: 17px;
        border: 1.5px solid #f0f0f0;
        padding: 10px 12px 10px 12px;
      }
      #prrfs:hover {
        background-color: #256;
        border: 1.5px solid DarkOrange;
        border-radius: 10px;
          -webkit-transition-delay: 0s;
          -moz-transition-delay: 0s;
          -ms-transition-delay: 0s;
          -o-transition-delay: 0s;
          transition-delay: 0s;
      }
      #titulo {
        background-color: #145 !important;
        margin-bottom: 37px !important;
        position: sticky !important;
        top: 17px !important;
        z-index: 1000 !important;
      }
    </style>

  </head>

<body>

<div id="contenido">

<div id="barrita"></div>

<h1><a href="https://github.com/jucardus/jucardus.github.io/blob/main/readme.md">Actividad reciente</a> en <a href="https://jucardus.github.io">Jucardus</a></h1>

<p><small>Algunos de los enlaces pueden estar rotos, por enviar a proyectos o páginas descontinuados.</small></p>

<div id="markdown-content"></div>

</div>

<script>
    let numeroEntradas = 0;
    async function loadMarkdown() {
        try {
            // Get raw markdown
            const rawUrl = 'https://raw.githubusercontent.com/jucardus/jucardus.github.io/main/readme.md';
            const markdownResponse = await fetch(rawUrl);

            if (!markdownResponse.ok) {
                throw new Error(`Failed to fetch markdown: ${markdownResponse.status}`);
            }

            const markdownText = await markdownResponse.text();

            // Extract activity section starting from line 3
            const activityContent = extractAndLimitActivity(markdownText);

            // First try: Render to HTML using GitHub API
            try {
                const htmlResponse = await fetch('https://api.github.com/markdown', {
                    method: 'POST',
                    headers: {
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        text: activityContent,
                        mode: 'markdown'
                    })
                });

                if (htmlResponse.ok) {
                    const html = await htmlResponse.text();
                    document.getElementById('markdown-content').innerHTML = html;
                    console.log('✓ Activity content loaded via GitHub API');
                    return; // Success - exit function
                } else {
                    throw new Error(`GitHub API error: ${htmlResponse.status}`);
                }
            } catch (apiError) {
                console.warn('GitHub API failed, falling back to client-side parsing:', apiError);

                // Fallback: Use client-side markdown parser
                fallbackToClientSideParsing(activityContent);
            }

        } catch (error) {
            console.error('Failed to load markdown:', error);
            document.getElementById('markdown-content').innerHTML =
                '<div class="fallback-warning">⚠️ Unable to load the activity content. Please check the console for errors.</div>';
        }
    }

    function extractAndLimitActivity(fullText) {
        // Split the entire file into lines
        const allLines = fullText.split('\n');
        
        // Start from line 3 (index 2) and go to the end
        // Change this number if you want to start from a different line
        const startLine = 2; // ← CHANGE THIS: 0 = first line, 1 = second line, 2 = third line, etc.
        
        if (startLine >= allLines.length) {
            return '### Actividad reciente\n\n*No activity content found*';
        }
        
        // Get everything from the starting line to the end
        const activityLines = allLines.slice(startLine);
        const activitySection = activityLines.join('\n');
        
        // Split into paragraphs (separated by double line breaks)
        const paragraphs = activitySection.split('\n\n');

        // Handle activity entries
        const activityEntries = paragraphs; // Now all paragraphs are activity entries
        
        const entryLimit = numeroEntradas; // ← 0 = all entries, any other number = limit

        let finalContent;

        if (entryLimit === 0) {
            // Show ALL entries - no limit, no truncation message
            finalContent = activityEntries.join('\n\n');
        } else {
            // Apply limit and show truncation message if needed
            const limitedEntries = activityEntries.slice(0, entryLimit);
            finalContent = limitedEntries.join('\n\n');

            // Add truncation note if we limited the entries
            if (activityEntries.length > entryLimit) {
                finalContent += '\n\n~ Para ver toda la actividad, clica <a href="https://github.com/jucardus/jucardus.github.io/blob/main/readme.md" rel="noopener noreferrer nofollow external" targett="_blank"><b>AQUÍ</b></a>. ~';
            }
        }

        return finalContent;
    }

    function fallbackToClientSideParsing(markdownText) {
        try {
            // Configure marked.js options to match GitHub flavor
            marked.setOptions({
                breaks: true,
                gfm: true,
                tables: true,
                sanitize: false
            });

            // Parse markdown to HTML
            const html = marked.parse(markdownText);

            // Show warning about using fallback
            const warning = '<div class="fallback-warning">ℹ️ Showing content with client-side rendering (GitHub API unavailable)</div>';
            document.getElementById('markdown-content').innerHTML = warning + html;

            console.log('✓ Activity content loaded via client-side parser');
        } catch (parseError) {
            console.error('Client-side parsing also failed:', parseError);
            document.getElementById('markdown-content').innerHTML =
                '<div class="fallback-warning">❌ Unable to render markdown content. Both GitHub API and client-side parsing failed.</div>';
        }
    }

    // Load content when page is ready
    document.addEventListener('DOMContentLoaded', loadMarkdown);
</script>

</body>
</html>
